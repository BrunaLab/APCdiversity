---
title             : "Assessing the effect of article processing charges on the geographic diversity of authors using Elsevier's 'Mirror Journal' system"
shorttitle        : "APCs & author diversity"

author: 
  - name          : "Audrey C. Smith"
    affiliation   : "1"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Methodology
      - Investigation
      - Formal analysis
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
    equal_contrib: yes
  - name          : "Leandra Merz"
    affiliation   : "1"
    role:
      - Methodology
      - Investigation
      - Formal analysis
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
    equal_contrib: yes
  - name          : "Jesse B. Borden"
    affiliation   : "1"
    role:
      - Methodology
      - Investigation
      - Software
      - Formal analysis
      - Writing - Review & Editing
  - name          : "Chris K. Gulick"
    affiliation   : "1"
    role:
      - Methodology
      - Investigation
      - Formal analysis
      - Writing - Review & Editing
  - name          : "Akhil R. Kshirsagar"
    affiliation   : "1"
    role:
      - Methodology
      - Investigation
      - Formal analysis 
      - Writing - Review & Editing
  - name          : "Emilio M. Bruna"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Center for Latin American Studies, University of Florida, PO Box 110530, Gainesville, Florida, 32611-0530 USA"
    email         : "embruna@ufl.edu"
    role:
      - Conceptualization
      - Methodology
      - Investigation
      - Formal analysis
      - Data curation
      - Visualization
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
      - Project administration
      - Supervision   

affiliation:
  - id            : "1"
    institution   : "University of Florida"

note:       | 
  A preprint of this article has been posted at MetaArXiv Preprints (osf.io/preprints/metaarxiv/s7cx4).



  ORCID:
    LM: 0000-0003-2356-7483 |
    EB: 0000-0003-3381-8477 |
    JB: 0000-0001-9413-9537 |
    AS: 0000-0003-1278-8889 | 
    AK: 0000-0001-5986-6608 |
    CG: 0000-0002-4482-711X |
  

    \newpage

authornote: |
  A. C. Smith, L. Merz, & A. R. Kshirsagar: and Department of Geography, University of Florida, PO Box 117315, Gainesville, Florida, 32611 USA
  J. B. Borden: School for Natural Resources and the Environment, University of Florida, PO Box 116455, Gainesville, Florida, 32611 USA
  C. Gulick: Department of Wildlife Ecology and Conservation, University of Florida, PO Box 110430, Gainesville, Florida, 32611 USA
  E. M. Bruna: Department of Wildlife Ecology and Conservation, University of Florida, PO Box 110430, Gainesville, Florida, 32611 USA and Center for Latin American Studies, University of Florida, PO Box 115530, Gainesville, Florida, 32611 USA 




abstract: |
  Journals publishing open access (OA) articles often require that authors pay article processing charges (APC). Researchers in the Global South often cite APCs as a major financial obstacle to OA publishing, especially in widely-recognized or prestigious outlets. Consequently, it has been hypothesized that authors from the Global South will be underrepresented in journals charging APCs. We tested this hypothesis using >37,000 articles from Elsevier's 'Mirror journal' system, in which a hybrid 'Parent' journal and its Gold-OA 'Mirror' share editorial boards and standards for acceptance. Most articles were non-OA; 45% of articles had lead authors based in either the United States of America (USA) or China. After correcting for the effect of this dominance and differences in sample size, we found that OA articles published in Parent and Mirror journals had lead authors with similar Geographic Diversity. However, Author Geographic Diversity of OA articles was significantly lower than that of non-OA articles. Most OA articles were written by authors in high-income countries, and there were no articles in Mirror journals by authors in low-income countries. Our results for Elsevier's Mirror-Parent system are consistent with the hypothesis that APCs are a barrier to OA publication for scientists from the Global South.
  
keywords          : "Open access, Global North, Global South, Gold OA, hybrid journals, Parent journals, Simpson's Index, waivers"
wordcount         : "5301"

bibliography      : ["APCpaper_QSS.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
numbersections    : yes
linenumbers       : yes
mask              : no
draft             : no
replace_ampersands: yes

documentclass     : "apa6"
classoption       : "man"

output: 
  papaja::apa6_pdf   
  # papaja::apa6_pdf:   
   # includes:
   # after_body: "appendix.tex"
   
# papaja::apa6_word   # apa6_word to render as a word doc
  
fig_caption: yes #yes will automatically add "Figure X" to the start 
# of the caption and reorders automatically if the figure position changes
always_allow_html: yes

# appendix: "Smith_etal_Appendix_QSSv1.Rmd"

header-includes:
  - \raggedbottom
  - \usepackage{endfloat} #[nomarkers] excludes the {insert figure x around here] from main text. The others exclude the list of tables and figures. https://cs.brown.edu/about/system/managed/latex/doc/endfloat.pdf
  - \usepackage{setspace}\doublespacing
  - \usepackage{lineno}
  - \linenumbers
  - \usepackage{tabu}
  - \usepackage{pdflscape}
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}

---

```{r GlobalOptions}
options(knitr.duplicate.label = 'allow',
        knitr.kable.NA = '')
knitr::opts_knit$set(eval.after = "fig.cap")
```

```{r setup, include = FALSE}
library("papaja")
r_refs("APCpaper_QSS.bib")
knitr::opts_chunk$set(echo = FALSE,message=FALSE,warning=FALSE)
library(tidyverse)
library(gridExtra)
library(kableExtra)
library(egg)
library(magick)
library(here)
# library(citr)
# library(devtools)
# devtools::install_github("crsh/papaja")
```

```{r load_data, cached=TRUE}
knitr::opts_chunk$set(echo = FALSE)

MirrorPairs <- read_csv(here("data_clean", "MirrorPairs.csv"))
WaiverCountries <- read_csv(here("data_clean","WaiverCountries.csv"))
AllData <- read_csv(here("data_clean","all_data_analysis.csv"))

AllData_missing <- AllData %>%
  filter(AuthorNum == 1) %>%
  filter(is.na(First_Author_Country)) %>%
  select(refID)
AllData <- AllData %>% filter(!refID %in% AllData_missing$refID)
rm(AllData_missing)

# df of single author pubs (all countries)
single_ALL <- AllData %>%
  filter(author == "solo") %>%
  mutate(Dataset = "All Countries") %>%
  drop_na("Code")
# n_distinct(single_ALL$refID)

# df of coauthored pubs (all countries)
first_ALL <- AllData %>%
  filter(author == "coauthored") %>%
  filter(AuthorNum == 1) %>%
  mutate(author = "author_first")

# df of single author pubs (no first authors from CHN or USA)
single_NOCHNUSA <- AllData %>%
  filter(author == "solo") %>%
  filter(Code != "CHN") %>%
  filter(Code != "USA") %>%
  mutate(Dataset = "CHN & USA excluded")

# df of coauthored pubs (no first authors from CHN or USA)
first_NOCHNUSA <- AllData %>%
  filter(author == "coauthored") %>%
  filter(AuthorNum == 1) %>%
  filter(Code != "CHN") %>%
  filter(Code != "USA") %>%
  mutate(Dataset = "CHN & USA excluded") %>%
  mutate(author = "author_first")

# Load Bootstrap Runs - COUNTRIES
BootOAinPW_Countries <- read_csv(here("data_clean","BootOAinPW_Countries.csv"))
BootMirror_Countries <- read_csv(here("data_clean","BootMirror_Countries.csv"))

# Load Bootstrap Runs - DIVERSITY
BootOAinPW_RichDiv <- read_csv(here("data_clean","BootOAinPW_RichDiv.csv"))

# Load Bootstrap Runs - OA in Mirror Journals
BootMirror_RichDiv <- read_csv(here("data_clean","BootMirror_RichDiv.csv"))

```

```{r apcstats, echo = FALSE, warning=FALSE,message = FALSE}
# Summary of APCs - Mirror Journals
APC <- MirrorPairs %>%
  filter(JrnlType == "OA") %>%
  summarize(
    medianAPC = median(APC),
    avg_APC = mean(APC),
    sd_APC = sd(APC),
    maxAPC = max(APC),
    minAPC = min(APC)
  )
APC_stats <- round(APC, 2)
max <- APC_stats[4]
min <- APC_stats[5]
mean <- APC_stats[2]
sd <- APC_stats[3]
median <- APC_stats[1]

# Summary of APCs - Parent (Subscription) Journals
APC_parent <- MirrorPairs %>%
  filter(JrnlType == "PW") %>%
  filter(is.na(APC) == FALSE) %>%
  summarize(
    medianAPC = median(APC),
    avg_APC = mean(APC),
    sd_APC = sd(APC),
    maxAPC = max(APC),
    minAPC = min(APC)
  )

APC_parent_stats <- round(APC_parent, 2)
max_parent <- APC_parent_stats[4]
min_parent <- APC_parent_stats[5]
mean_parent <- APC_parent_stats[2]
sd_parent <- APC_parent_stats[3]
median_parent <- APC_parent_stats[1]

# Difference between APCs for Mirror & Parent journal APCs (if there is one)
APC_mirror <- MirrorPairs %>%
  filter(JrnlType == "OA")
APC_parent <- MirrorPairs %>%
  filter(JrnlType == "PW")
APC_diff <- inner_join(APC_mirror, APC_parent, by = "pair_key")

APC_diff$APC_diff <- APC_diff$APC.y - APC_diff$APC.x
APC_diff <- na.omit(APC_diff)
APC_diff_mean <- mean(APC_diff$APC_diff)
APC_diff_range <- range(APC_diff$APC_diff)
APC_diff_median <- median(APC_diff$APC_diff)
diff_conditional <- APC_diff %>%
  select(APC_diff) %>%
  filter(APC_diff != 0) %>%
  summarize(
    avg_diff = mean(APC_diff),
    sd_diff = sd(APC_diff)
  )


```

```{r njournals, echo = FALSE, warning=FALSE,message = FALSE}
# No. of journals by jrnl type
n_journals <- AllData %>%
  group_by(JrnlType) %>%
  summarize(n = n_distinct(Journal))
n_journals_tot <- sum(n_journals$n)

njournalsOA <- as.numeric(n_journals[1, 2])
njournalsPW <- as.numeric(n_journals[2, 2])
```

```{r npapers, echo=FALSE,message = FALSE,warning=FALSE}
# number of papers by journal type
NumbArticles_JrnlType <- AllData %>%
  group_by(JrnlType, ArticleType) %>%
  summarize(n = n_distinct(refID))
n_OA <- as.numeric(NumbArticles_JrnlType[1, 3])
n_OAinPW <- as.numeric(NumbArticles_JrnlType[2, 3])
n_PW <- as.numeric(NumbArticles_JrnlType[3, 3])
Total_pubs <- sum(NumbArticles_JrnlType$n)

# No. of Single Author papers by journal type / article type
NumbSoloArticles_JrnlType <- single_ALL %>%
  group_by(JrnlType, ArticleType) %>%
  summarize(n = n_distinct(refID))
OA_solo <- as.numeric(NumbSoloArticles_JrnlType[1, 3])
OAinPW_solo <- as.numeric(NumbSoloArticles_JrnlType[2, 3])
PW_solo <- as.numeric(NumbSoloArticles_JrnlType[3, 3])

# No. of Coauthored papers by journal type / article type
NumbCoAuthoredArticles_JrnlType <- first_ALL %>%
  group_by(JrnlType, ArticleType) %>%
  summarize(n = n_distinct(refID))
OA_coauthored <- as.numeric(NumbCoAuthoredArticles_JrnlType[1, 3])
OAinPW_coauthored <- as.numeric(NumbCoAuthoredArticles_JrnlType[2, 3])
PW_coauthored <- as.numeric(NumbCoAuthoredArticles_JrnlType[3, 3])
```

```{r ncountries, echo=FALSE,message = FALSE,warning=FALSE}
# Total Countries: OA Mirror journals
n_OA_countries <- AllData %>%
  filter(JrnlType == "OA") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: OA articles in Parent journals
n_OAinPW_countries <- AllData %>%
  filter(ArticleType == "OA" & JrnlType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: Parent journals
n_PW_countries <- AllData %>%
  filter(ArticleType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: single-authored papers
n_countries_single_authors <- single_ALL %>%
  summarize(n = n_distinct(Code))

# Total Countries: single-authored papers in Mirror journals
n_countries_OA_single_authors <- single_ALL %>%
  filter(JrnlType == "OA") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: single-authored OA papers in Parent journals
n_countries_OAinPW_single_authors <- single_ALL %>%
  filter(ArticleType == "OA" & JrnlType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: single author papers in Parent (OA+nonOA)
n_countries_PW_single_authors <- single_ALL %>%
  filter(JrnlType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: single author non-OA papers in Parent journals
n_countries_PWinPW_single_authors <- single_ALL %>%
  filter(ArticleType == "PW" & JrnlType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: Co-authored papers in Mirror Journals
n_countries_OA_CO_authors <- first_ALL %>%
  filter(JrnlType == "OA") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: Co-authored OA papers in Parent Journals
n_countries_OAinPW_CO_authors <- first_ALL %>%
  filter(ArticleType == "OA" & JrnlType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: Co-authored non-OA papers in Parent journals
n_countries_PWinPW_CO_authors <- first_ALL %>%
  filter(ArticleType == "PW" & JrnlType == "PW") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

# Total Countries: first authors of co-authored papers
n_countries_FIRST_authors <- first_ALL %>%
  summarize(n = n_distinct(Code))

# Total Countries: All papers
countries_first_and_single <- (c(
  single_ALL$Code,
  first_ALL$Code
))

# Total Countries: all first authors (single+first of authored)
n_countries_FIRST_AND_single_authors <- n_distinct(countries_first_and_single)
n_countries_total <- n_countries_FIRST_AND_single_authors

# Countries by Journal Type: single-authored papers
n_countries_single_by_jrnl <- single_ALL %>%
  group_by(JrnlType) %>%
  summarize(n = n_distinct(Code))
nsingleOA <- n_countries_single_by_jrnl[1, 2]
nsingleOAinPW <- n_countries_single_by_jrnl[2, 2]
nsinglePW <- n_countries_single_by_jrnl[3, 2]

# Countries by Journal Type: co-authored papers
n_countries_FIRST_by_jrnl <- first_ALL %>%
  group_by(JrnlType) %>%
  summarize(n = n_distinct(Code))
nCoOA <- n_countries_FIRST_by_jrnl[1, 2]
nCoOAinPW <- n_countries_FIRST_by_jrnl[2, 2]
nCoPW <- n_countries_FIRST_by_jrnl[3, 2]

# percent of articles with author in USA or CHN (All Papers combined)
n_articles_first_CHN_USA <- AllData %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "CHN" | Code == "USA") %>%
  summarize(n = n_distinct(refID))

Perc_USA_orCHN <- as.numeric(round(n_articles_first_CHN_USA / Total_pubs * 100, 2))

# number of OA articles with author in USA (Mirror + OA in PW)
n_articles_first_USA_OA <- AllData %>%
  filter(ArticleType == "OA") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "USA") %>%
  group_by(JrnlType, ArticleType) %>%
  summarize(n = n_distinct(refID))

# number of OA articles with author in CHN (Mirror + OA in PW)
n_articles_first_CHN_OA <- AllData %>%
  filter(ArticleType == "OA") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "CHN") %>%
  group_by(JrnlType, ArticleType) %>%
  summarize(n = n_distinct(refID))

# number of OA articles with author in USA (OA in PW)
n_articles_first_USA_OAinPW <- AllData %>%
  filter(JrnlType == "PW") %>%
  filter(ArticleType == "OA") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "USA") %>%
  summarize(n = n_distinct(refID))



# number of OA articles with author in USA (mirror)
n_articles_first_USA_OAinPW <- AllData %>%
  filter(JrnlType == "OA") %>%
  filter(ArticleType == "OA") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "USA") %>%
  summarize(n = n_distinct(refID))


# number of OA articles with author in CHN (OA in PW)
n_articles_first_USA_OAinPW <- AllData %>%
  filter(JrnlType == "PW") %>%
  filter(ArticleType == "OA") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "CHN") %>%
  summarize(n = n_distinct(refID))

# number of OA articles with author in USA (mirror)
n_articles_first_USA_OAinPW <- AllData %>%
  filter(JrnlType == "OA") %>%
  filter(ArticleType == "OA") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "CHN") %>%
  summarize(n = n_distinct(refID))

# number of PW articles with author in USA
n_articles_first_USA_PW <- AllData %>%
  filter(ArticleType == "PW") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "USA") %>%
  summarize(n = n_distinct(refID))

# number of PW articles with author in CHN
n_articles_first_CHN_PW <- AllData %>%
  filter(ArticleType == "PW") %>%
  filter(AuthorNum == 1) %>%
  filter(Code == "CHN") %>%
  summarize(n = n_distinct(refID))
#
ratioOA_USAtoCHN <- round(sum(n_articles_first_USA_OA$n) / sum(n_articles_first_CHN_OA$n))
ratioPW_CHNtoUSA <- round(sum(n_articles_first_CHN_PW$n) / sum(n_articles_first_USA_PW$n))


# Total Low-income Countries: OA in PW journals
n_countries_low <- AllData %>%
  # filter(ArticleType=="OA" & JrnlType=="PW") %>%
  filter(IncomeGroup == "Low") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))

countries_low_freq <- AllData %>%
  # filter(ArticleType=="OA" & JrnlType=="PW") %>%
  filter(IncomeGroup == "Low") %>%
  filter(AuthorNum == 1) %>%
  group_by(Code) %>%
  summarize(n = n()) %>%
  arrange(desc(n))

regions_low_freq <- AllData %>%
  # filter(ArticleType=="OA" & JrnlType=="PW") %>%
  filter(IncomeGroup == "Low") %>%
  filter(AuthorNum == 1) %>%
  group_by(Region) %>%
  summarize(n = n()) %>%
  arrange(desc(n))


n_countries_high <- AllData %>%
  # filter(ArticleType=="OA" & JrnlType=="PW") %>%
  filter(IncomeGroup == "High") %>%
  filter(AuthorNum == 1) %>%
  summarize(n = n_distinct(Code))


```

# Introduction

Open Access articles can be read without payment or subscription to the journal in which they were published, and the number of OA articles published annually continues to grow dramatically [@piwowar_state_2018]. In addition to benefiting readers without access to traditional subscription-based journals, open access (i.e., OA) publishing can also benefit an article's authors [reviewed in @mckiernan_how_2016; @tennant_academic_2016]. For instance, OA articles can garner more online views, have higher download rates, and accrue more citations over time than articles in subscription outlets [@davis_open_2011; @eysenbach_citation_2006; @wang_open_2015]. Metrics such as these are increasingly taken into consideration when conducting performance evaluations of scientists, including the tenure and promotion process in academic institutions [@schimanski_evaluation_2018]. Publishing OA articles can therefore play an important role in a scientist's professional advancement and status [@macleavy_unintended_2020; @mckiernan_how_2016]. These benefits may accrue regardless of whether publishing in 'Gold OA' journals, where all articles are immediately available, in 'hybrid' journals that publish both OA and subscription-only content, or when authors place a version of their article in a repository (i.e., self-archiving or "Green OA) [@piwowar_state_2018]. However, the professional value of OA is likely to be especially high when publishing in Gold OA journals, especially if they have other characteristics valued by evaluators: name recognition, high impact factor, perceived prestige, or association with certain academic societies [@gray_sorry_2020; @schimanski_evaluation_2018].\
Furthermore, publication in Gold OA journals is increasingly required by government agencies and private foundations that fund research [@bjork_how_2014; @pinfield_medical_2013]. Most Gold OA journals allow authors to publish at no expense [@crow_income_2009]. However, the vast majority of OA articles are published in a subset of OA journals that require authors pay an 'article processing charge' (APC) to help defray the cost of journal operations or lost subscription revenue [@crow_income_2009; @kozak_publication_2013; @openapc_openapc_2020; @pavan_article_2018; @piwowar_state_2018]. A recent survey found that OA journals charging APCs -- a list that includes the most prestigious and widely recognized Gold OA outlets -- the average APC was \$908 ($\pm$ \$608 SD, N = 4418 journals), with 500 journals charging at least \$2000 and 12 journals charging APCs over \$4000 [@morrison_oa_2019; @singh_oa_2019]. For many researchers, especially those working in the Global South[^1], these APCs are an insurmountable financial obstacle that prevents them from publishing in the most desirable OA journals [@bahlai_open_2019; @matheka_open_2014; @peterson_open_2013]. This is especially true for scholars writing without any coauthors that could potentially contribute a portion of the APC. It is even the case for those with access to funding, as even modest APCs can consume a large fraction of their research budget [@pavan_article_2018]. Although publishers have attempted to address this with policies aimed at reducing or even waiving APCs for authors in some countries, many researchers in the Global South are ineligible for even partial waivers [@ellers_gold_2017; @lawson_fee_2015, Table S1]. This has led many to argue that the APCs allowing authors in low-income countries to read previously inaccessible journals simultaneously prevent them from publishing in the same journals [@ellers_gold_2017; @fonturbel_paywall_2021; @matheka_open_2014; @poynder_plan_2019].\
Despite the prevalence of this assertion, tests of whether APCs shape author representation in the OA literature remain rare [@ellers_gold_2017]. This is largely because it has been challenging, if not impossible, to identify journals for comparison whose primary difference is whether or not they charge APCs. In 2018, however, the publishing company Elsevier introduced the concept of 'Mirror" journals' -- Gold OA versions of established Hybrid titles with identical editorial boards, peer review procedures, and standards for acceptance [@cochrane_are_2018; @harrison_what_2019]. The goal was for this identical editorial structure, coupled with a nearly identical name (e.g., *Journal of Dentistry / Journal of Dentistry: X*, *Ecological Engineering / Ecological Engineering: X*), to elevate the visibility and status of the OA Mirrors to a level comparable to their Hybrid "Parent" journal [@harrison_what_2019], thereby attracting authors preferring to publish in a Gold OA journal or required to do so by the organization funding their research. All Mirror journals charge an APC (median = \$`r median`, range = \$`r min`--\$`r max`, Table 1); as with most Hybrid journals there is no cost to authors publishing in Parent journals unless they wish their article to be open access. For many of the Parent-Mirror pairs the APC was identical, but in cases where it was not the APCs of Parent journals were on average \$`r diff_conditional$avg_diff` ($\pm$ `r diff_conditional$sd_diff`) higher. Mirror and Parent journals are cross-promoted on each others' websites, as are the publisher's APC waiver policies.\
The Parent-Mirror system is an ideal 'natural experiment' with which to test for associations between APCs and author diversity. First, it eliminates three of the major factors that have hampered prior comparisons of OA and subscription journals: between-journal differences in aims and scope, potential author base, and the editorial process and criteria with which manuscripts are evaluated. In addition, several of the journal websites emphasize that articles are processed with neither editors nor referees aware of whether an article was submitted to the Parent or Mirror journal, which helps ameliorate any potential effects of any editor or referee biases. Third, the 38 journal pairs span a breadth of disciplines ranging from environmental policy to particle physics to veterinary medicine. This, coupled with our sampling design, allows us to draw broader generalizations than if we had limited our analyses to journals from a single field. Finally, one can compare the authors of articles in the Mirror with those of OA articles in the Parent journal. This comparison can be used to infer whether any Parent-Mirror differences could in fact be due to factors other than APCs that also shape author submission decisions, such as journal impact factor, national incentives, funder mandates, prior experience with the Parent journal, or limited familiarity with Mirror journals.\
We used data from over `r format(round(Total_pubs,digits=-3),big.mark=",")` articles published in `r njournalsPW` Parent journals and their respective Mirrors to investigate the relationship between APCs and the geographic structure of author communities. We test three predictions: First, that the geographic diversity of authors publishing in Mirror journals would be similar to that of authors publishing OA articles in Parent journals. Second, that the geographic diversity of authors publishing OA articles - whether in Mirror journals or Parent journals -- would be lower than that of non-OA articles in Parent journals. Third, that any such reductions would be due to OA articles having fewer lead authors (i.e., first- or single-authors) from the low-income countries predominantly located in the Global South. We tested these hypotheses using diversity indices derived from information theory that are commonly used across disciplines for quantifying and comparing the structure of groups [@calver_quantifying_2018; @espin_persistent_2017; @magurran_measuring_2004]. In doing so we not only provide a robust analysis of the association between APCs and author representation, but also the first comparison of author communities in the Mirror-Parent publishing framework.

[^1]: The world's 'developing' or 'emerging' economies primarily located in Latin America, Asia, Africa, and the Middle East [@brandt_north-south_1980].

# Methods

In July 2020, we downloaded the complete reference records for all "Articles" and "Reviews" published in `r njournalsOA` Mirror journals (Table 1) from the Web of Science Core Collection and SCOPUS databases. We then identified the date of the first publication in each Mirror journal and downloaded the records of all articles published in the corresponding Parent journal from that date through July 2020 (Table 1). Each article from the Parent journals was identified as being either OA or "non-OA", i.e., requiring a subscription or payment to read. Finally, for all papers we identified the country in which the first author's primary institution of affiliation was located and assigned that country to its respective World Bank Region[^2], World Bank Lending Group[^3] [@world_bank_world_2020], and Elsevier "Research4Life" APC Waiver Group (100% Waiver, 50% Waiver, No Waiver; Table S1).\
To quantify the geographic structure of our focal author communities we used a diversity index derived from information theory. The most commonly used diversity metrics are calculated using two pieces of information. The first is Richness (*R*), which is the number of distinct categories contained in a sample (e.g., the number of countries in which authors from a group of journals are based). The second is Evenness, which is the relative frequency of each category in the sample (i.e., the relative proportion of authors based in each country). A robust and widely used diversity index is the reciprocal transformation of Simpson's Index:

[^2]: Europe/Central Asia, East Asia/Pacific, Latin America/Caribbean, Sub-Saharan Africa, South Asia, Middle East/North Africa, North America (i.e., Canada, United States).

[^3]: High Income (per capita GNI \> \$12476, including both Organization for Economic Cooperation and Development (OECD) member and non-OECD member, Upper-middle income (per capita GNI \$4036--\$12475), Lower-middle income (per capita GNI \$1026--\$4035), Low-income (per capita GNI \< \$1025)

$D_{2}=\frac{1}{\sum_{i-1}^{R} p_{i}^{2}}$

where *R* is the maximum value of Richness, and $p_{i}$ is the proportional abundance of type *i* during time interval *t*. Values of $D_{2}$ calculated for different groups are directly comparable; larger values of $D_{2}$ indicate greater diversity, with the maximum potential diversity equal to the highest value of Richness in the group [@magurran_measuring_2004].\
We began by comparing the geographic diversity of authors publishing in OA Mirror journals with that of authors publishing OA articles in Parent journals (Prediction 1) using permutations tests. We found no evidence of a difference in the Geographic Diversity of authors of these two groups of OA articles (For additional details see Table S2, Figure S3).  
*Correcting for differences in sample size:* The number of OA articles in both Parent and Mirror journals precluded robust comparisons of Geographic Diversity for journal pairs. We therefore calculated and compared the Geographic Diversity ($D_{2}$) of lead authors at the level of 'article type': OA articles in Mirror journals (i.e., 'MOA'), OA articles in Parent journals (i.e., 'POA'), and subscription-only (i.e., 'non-OA') articles in Parent journals (Psub)). It is important to note, however, that we cannot simply pool the OA and non-OA articles from the different journals and compare the resulting Diversity scores of the three groups. This is because there were `r  as.numeric(round(n_PW/(n_OA+n_OAinPW),0))`-fold more subscription-only articles than OA articles, and Richness -- which is used to calculate ($D_{2}$) -- increases with sample size. Furthermore, any analyses conducted on a collection of articles drawn from multiple journals would be skewed by patterns in the journals with the most articles. We therefore used abundance-matched bootstrapping [@efron_introduction_1994] to compare the geographic diversity of the pooled OA articles with that of 1000 different collections of non-OA articles. These collections were generated by counting the number of articles published in each Mirror, then randomly sampling with replacement an identical number of subscription-only articles from the respective Parent journal [@fox_bootstrapping_2015]. To determine if the Geographic Diversity of authors for MOA and POA articles were significantly different from that of PSub articles we calculated $\hat{P}$ -- the proportion of Psub collections whose value of $D_{2}$ was below that of each OA collection. A $\hat{P}$ \> 0.975 indicates the Diversity of an OA collection is significantly greater than that of the Psub samples; OA Diversity is significantly lower than that of Psub samples when $\hat{P}$ \< 0.025. The same procedure was used to compare the proportion of Psub and OA articles written by authors based in different global regions, national income categories, and APC waiver categories. Results for the MOA vs. Psub and POA vs. Psub comparisons were qualitatively similar, so we report only the results for of the MOA vs. Psub comparison.\
The analyses above were conducted for two types of lead authors: (1) the authors of single-authored papers, and (2) the first authors of co-authored papers. We analyzed single- and co-authored papers separately because of the potential insights into financial constraints that could emerge from divergent results for these author types: while the APC for a single-authored paper is the responsibility of one person, the APC of a co-authored paper can potentially be divided among -- or even paid entirely by -- co-authors with access to funding.\
*Assessing and Correcting for Categorical Dominance:* Simpson's Index is robust to moderate differences in sampling effort. However, it is sensitive to how equitably samples are distributed between categories [i.e., it is a 'dominance' or 'evenness' index, @magurran_measuring_2004], meaning more dominant categories will have disproportionately greater effects on $D_{2}$. Failure to consider this effect can lead to incorrect inference regarding differences in diversity, especially in cases where dominance is most pronounced. This is because a small number of dominant categories can dramatically lower $D_{2}$ even if the number of remaining categories and their proportional representation are identical. Put another way, dominant categories "suppress" the contributions to diversity of the other categories in a group.\
Because more than 40% of first authors were based in either China or the United States (Fig. S1), we sought to assess if this dominance could be biasing estimates of author diversity. To do so we conducted a series of simulations in which we sequentially removed authors from each country and measured the resulting change in $D_{2}$. China was the only country whose exclusion led to increased diversity, with a relative effect on $D_{2}$ that was 142 times that of any other country (Fig S2). We then excluded all papers with first authors based in China and repeated our simulations. Diversity only increased (8-fold) when excluding articles with first authors based in the USA, with a relative effect on diversity that was 31 times greater than that of any other country (Fig S2). These results indicate that there is a large and negative bias in $D_{2}$ when including authors from the USA and China in analyses. We therefore conducted all analyses both with and without authors from these two countries. We also repeated all analyses with Shannon's Index, which is somewhat less sensitive to extreme differences in relative frequency than Simpson's Index. Results for Simpson's and Shannon's indices were qualitatively similar (Fig. S4), so we present here only the results for Simpson's Index.\
All data analyses were carried out with code written in the R statistical programming language [@r_core_team_r_2020]. We used the **`refplitr`** [@fournier_refsplitr_2020] and **`bibliometrix`** [@aria_bibliometrix_2017] libraries to process the Web of Science and SCOPUS records (respectively) and georeference lead authors. These packages were unable to georeference the addresses of 52 first authors; we identified the country in which these authors were based from the original articles. Richness and Diversity were calculated with the **`vegan`** library [@oksanen_vegan_2019], while **`ggplot2`** [@wickham_welcome_2019] was used for all data visualizations[^4].

[^4]: Available at <https://github.com/embruna/APCdiversity> for review and improvement; the version used for this manuscript will be permanently archived at Zenodo and included in the References upon acceptance.

# Results

The `r njournalsOA` Mirror journals published `r n_OA` articles from their inception through the date we downloaded the article records. During the same interval, their respective Parent journals published `r n_PW+n_OAinPW` articles, of which `r n_OAinPW` were open access (Table 1). Lead authors were collectively based in `r n_countries_total` countries (i.e., all journals and article categories pooled). However, the number of countries in which authors were based varied substantially among categories (Table S3), as did the relative frequency of countries in which authors were based (i.e., Evenness, Table S3). For example, authors of single-author publications, which accounted for `r round(OA_solo/n_OA*100,0)`% of the articles in Mirror journals (N = `r OA_solo`) but only `r round(PW_solo/(n_PW+n_OAinPW)*100,0)`% of articles in Parent journals (N = `r PW_solo`), were collectively based in N = `r n_countries_single_authors` countries. However, the authors of single-authored OA articles in Mirror and Parent journals were based in N = `r n_countries_OA_single_authors` and N = `r n_countries_OAinPW_single_authors`, respectively (Table 2). While `r round(Perc_USA_orCHN,0)`% of articles had a lead author whose primary institutional address was in either the United States of America (USA) or China (Fig. S1), there was an important difference among journal types in the representation of authors from these two countries. While USA authors published approximately `r ratioOA_USAtoCHN`-times more OA articles than authors based in China, authors from China published `r ratioPW_CHNtoUSA`-times more subscription-only articles in Parent journals than authors from the USA (Figs. 1, 2).

## Geographic Diversity

*First Authors of co-authored articles:* When including all countries, there was no significant difference in the Geographic Diversity of authors that published OA and Subscription articles, regardless of whether the OA articles were published in Mirror or Parent journals. After correcting for the dominance of authors based in the USA and China, however, the Geographic Diversity of authors publishing OA articles was siginificantly lower than that of authors publishing Subscription articles. This was true for both OA articles published in Mirror journals ($D_2^{MOA}$ = 17.5 vs $\bar{D}_2^{Psub}$ = 24.24 $\pm$ 1.46 SD) and those published in Parent journals ($D_2^{POA}$ = 16.4$\bar{D}_2^{Psub}$ = 24.31 $\pm$ 0.86 SD; Fig. 3, Table 2).\
*Single-author articles:* The results were similar when comparing Single Author OA articles published in Mirror journals with subscription articles in Parent journals: there was no significant difference in the values of $D_{2}$ when all countries were included, but author diversity for OA articles was was significantly lower once China and the USA had been removed (Fig. 3, Table 2). In contrast to the other comparisons, however, there was no significant difference in author diversity between OA and subscription articles in Parent journals, regardless of whether China and the USA were included in the analyses (Table 2). This comparison encompasses <3% of the total number of articles published during our focal time-frame. 

## Global Regions, National Income, and Waiver Categories
After correcting for differences in sample size by bootstrapping, we found that articles in Mirror journals had significantly more authors from North America and the East Asia / Pacific region than subscription-only articles in Parent journals. They also had significantly fewer authors from Latin American and the Caribbean, the Middle East and North Africa, and Sub-Saharan Africa (Fig. 4, Table 4). Consequently, the authors of articles in Mirror journals were significantly more likely to be based in high-income countries (Fig. 5, Table 5), with authors from middle-income countries significantly underrepresented. Overall, a nearly identical proportion of subscription-only articles in Parent journals had first authors based in upper-middle and high-income countries (47.3% and 47.5%, respectively). In contrast, an overwhelming majority of articles in Mirror journals were written by first-authors based in the high-income countries of the Global North (81%; Fig. S3).\
The lack of lead authors from low-income countries was especially notable. None of the `r n_OA` articles in Mirror journals, and only `r ((13+39+0+2)/Total_pubs*100)`% of the articles in Parent journals, were written by lead authors based in low-income countries. Of these, the overwhelming majority were non-OA articles in Parent journals (N = 41 of 54; Fig. 1B). When pooling across all journal and article types, there were authors from N = `r n_countries_low` low-income countries (vs. N = `r n_countries_high` high- income countries, Fig. 2B). Ethiopia was the most productive low-income country (N=9 articles), followed by the People's Republic of Korea (N = 8). Finally, authors in countries eligible for APC waivers published almost no open access articles in either Mirror or Parent journals -- they published almost entirely subscription-only articles in Parent journals (Fig. 6).\

# Discussion

One of the central tenets of open access publishing is that it helps make the scientific community more globally inclusive. This is considered particularly beneficial to scientific communities with limited financial resources, such as those in many countries of the Global South [@iyandemye_low_2019; @matheka_open_2014; @ncayiyana_open_2005]. While this benefit is undisputed, it has been suggested that OA publishing also has unintended negative consequences for the same author communities. Chief among these is that the open access funding model used by the most widely recognized and prestigious journals -- a reliance on article processing charges -- allows for readers with limited financial resources to access this scientific literature while preventing them from contributing to it. We found that for the overwhelming majority of articles published in the Mirror-Parent ecosystem, the Author Geographic Diversity of articles requiring APCs was significantly lower than that of articles requiring no fee. This was true regardless of whether the OA articles were published in the established Parent journals or the Gold OA Mirrors. The overwhelming majority of these OA articles also had lead authors based in high-income countries. Despite being based in countries nominally eligible for APC waivers, authors from middle-income countries published proportionally few open access articles, while authors in low-income countries published almost entirely subscription-only articles in Parent journals. Taken together, these results strongly suggest that APCs are a barrier to Open Access publication by scientists from the low-income countries of the Global South.\
Although authors of articles in Mirror and Parent journals were based in similar numbers of countries, the specific countries in which they were based were markedly different. Articles in Mirror journals had a far higher proportion of authors from North America, Europe/Central Asia, and the East Asia/Pacific region than similarly sized collections of non-OA articles (Fig. 4). This is in sharp contrast to the non-OA articles in Parent journals, where proportionately more authors were based in Sub-Saharan Africa, South Asia, the Middle East/North Africa, and Latin America/The Caribbean. This geographic distribution means that the the authorship of OA articles is overwhelmingly concentrated in high-income countries (Fig. 5, Fig. S5). Middle-income countries are also proportionately underrepresented in the open access literature. Five of the 15 countries publishing the most OA articles were in that category (i.e., China, India, Brazil, Mexico, Egypt; Fig. 2A), vs. seven for subscription-only articles (China, India, Brazil, Iran, Turkey, Russia, Mexico; Fig. 2B).\
Of the more than `r format(round(Total_pubs,digits=-3),big.mark=",")` we reviewed, only `r ((13+39+0+2)/Total_pubs*100)`% had lead authors based in low-income countries. Almost 55% of these were by authors in only 4 countries -- Ethiopia, North Korea, Nepal, and Syria, with the remainder by authors in `r n_countries_low-4` others. While this is consistent with the results of prior studies [e.g., @nunez_assessing_2019; @stocks_geographical_2008], we were nevertheless surprised to see that only (`r round((13)/(13+39+2),2)`%) of these were OA - the journals we reviewed all publish research relevant to researchers based in low-income countries (Table 1), and many of these countries have previously been shown to have high rates of OA publication [@iyandemye_low_2019]. Prior studies of regional variation in OA uptake, however, have all included OA journals in which authors could publish at no cost. When surveyed, authors -- especially independent researchers, students, and those at institutions focusing on undergraduate education -- have identified APCs as a barrier to publication [@coonin_publishing_2009; @dallmeier-tiessen_highlights_2011; @warlick_factors_2007]. We provide some of the strongest evidence to date supporting the assertion that is also the case for researchers in the Global South [@appel_adoption_2019; @ezema_open_2017; @ncayiyana_open_2005] -- at least for those submitting to the `r n_journals_tot` journals included in our review.\
Although it is conceivable that the differences we observed are due to many of our focal journals having above average APCs [@solomon_publication_2012], we believe this is unlikely to be the cause. Authors in low-income countries report a single APC can frequently consume much of a research project's budget. Authors in low-income countries are also far more likely to use personal funds to pay APCs [@solomon_study_2012]; even APCs well below the average of \$904 often exceed their monthly salary [@peterson_open_2013] or student stipend (Table 3). Of course funds to defray publication costs are clearly available to some scientists in some of these countries [@pavan_article_2018, Figs. 1 & 2]. The most likely explanation for the observed results is therefore that authors are actively choosing to publish at no cost in the Parent journal instead of paying to publish in the OA Mirror [@ciocca_reality_2017].\
The lack of OA articles by authors based in low-income countries is particularly surprising given that most of these countries are eligible for APC waivers via the Elsevier's "Research4Life" program (Table S1). We suggest there are at least three potential explanations for this. The first is that publisher policies for waiving APCs can be quite restrictive. For instance, the publisher of the journals included in our review will only waive APCs in cases where every co-author of an article is based in a country that is waiver-eligible [@elsevier_eligibility_2020]. Many of the articles in our dataset with first authors based in low-income countries had international collaborators in locations that rendered the articles ineligible for discounted or free publication [see also @gray_sorry_2020]. Second, it may be that authors were unaware waivers existed [@powell_achieving_2020] or that journal or publisher's staff failed to recognize their eligibility and offer to transfer their submission to the OA Mirror [@lawson_fee_2015]. Finally, even large discounts on APCs are unlikely to be sufficient for many authors [@iyandemye_low_2019]. This is almost certainly true for authors in countries that are bizarrely offered only partial discounts despite socioeconomic conditions that are similar to those in nearby countries where authors can publish OA at no expense (e.g., Honduras and Guatemala vs. Nicaragua, respectively; Table S1). In absolute terms, however, the minimal benefit of partial waivers may be most pronounced for authors in middle income countries such as Brazil, Mexico, South Africa, and Malaysia -- especially when they engage in productive collaborations with scientists based in other middle-income countries [@smith_scientific_2014] that are ineligible for waivers despite challenging economic conditions [@ciocca_reality_2017]. Regardless of the mechanism, our results suggest that waiver programs designed to increase the representation of scientists from the Global South in the OA literature by reducing APCs have at best failed to do so, and at worst had the opposite effect.Â Finally, our results also suggest there are some important differences in the way authors perceive Parent and Mirror journals. That there are some OA articles by authors from low-income countries in Parent journals but none in Mirror journals suggests a preference for more established titles. The same appears to be true for authors in high- and middle-income countries, who generally publish far more OA papers in Parent journals than their respective Mirrors (Fig 7). This skew is particularly notable given that publication in Gold-OA journals is increasingly required by funders in some of these countries. Finally, the results suggest authors in two of the world's leading producers of scientific publications -- China and the USA [@zhou_emergence_2006] -- either remain wary of OA publication or do not find the incentives for publishing OA particularly compelling [@jamali_national_2020; @xu_chinese_2020]. When these authors have opted for OA, the clearly prefer established Parent journals over the recently established Mirrors.

## Caveats and Future Directions

Inference in bibliometric studies must be drawn with care, as patterns such as those we documented are the result of a complex combination of pre-submission decisions by authors and post-submission decisions by editors. However, the ability to compare OA articles published in Mirror and Parent journals means we can control for many of the factors influencing these decisions. Most notably, the journals in a Mirror-Parent pair have identical editorial boards, editorial philosophy, and publication priorities. While any implicit biases held by editors against authors from particular countries would undoubtedly reduce the overall representation of these countries in the literature, the reduction would be independent of which publication type was chosen by authors. In addition, the journals in our analyses are all published by a single company -- with a few exceptions (e.g., the *Series B* journals of the American Mathematical Society), the mirror journal concept has yet to be adopted by other publishers or academic societies. However, these journals represent a wide-range of disciplines and are marketed to a global author pool and readership. As such, we believe our results are consistent with APCs being a key mechanism underlying pre-submission decisions by authors [@ciocca_reality_2017; @solomon_study_2012].\
Our results also suggest several promising directions for future research. The first is to investigate why scientists in many countries (e.g., China, USA, United Kingdom) apparently prefer publishing OA articles in Parent journals. These academic communities might consider open access Mirrors to be of lower quality [@ellers_gold_2017] or be unsure of their status with respect to funder mandates, regardless of the journal's affiliation with an academic society, publisher, or connection with an established subscription journal [@editage_geographic_2018]. Authors may also be hesitant to consider them as outlets for their work because they do not yet have impact factors or other metrics used for evaluating personnel, programs, or institutions [@appel_adoption_2019; @pavan_article_2018; @xu_chinese_2020]. Finally, they might also be concerned regarding their status with respect to the OA mandates of their particular funders and institutions in light of the recent decision that mirror-journals are not 'Plan S'-compliant [@coalitions_addendum_2021].\
Second, it is unclear why single-author papers are so much more common in Mirror-journals than they are in Parent journals. The choice to publish in OA Mirrors could be based on the content or format of the article (e.g., essay vs. data paper), or that particular authors have access to funds with which to pay APCs. However, it could also reflect deference by first-authors to coauthors preferring to publish in Parent journals, potentially coupled with disciplinary differences in norms regarding coauthorship and author order [@fox_patterns_2018; @parish_dynamics_2018]. While previous studies have elucidated individual author preferences regarding journal choice and manuscript submission [@rowley_factors_2020], little is known about how submission choices are influenced by the preferences of co-authors. The data presented here suggest that they can be, particularly with when it comes to the decision to submit to OA outlets such as Mirror journals.\
Finally, our results point to the need for research on how to make waiver programs a more effective means of reducing financial barriers to OA publication. In addition to the impact of rules that limit waivers for authors from low-income based on where their coauthors are based, we suggest that authors in middle-income countries merit particular attention: many are ineligible for even partial APC waivers, and even partial waivers are often insufficient. Insights into these topics will help editors, publishers, and the broader scientific community develop strategies to ensure prestigious open access journals are truly accessible to scientists from the Global South [@rodriguez_awareness_2014].

# Acknowledgements

We thank N. Emery, C. Scott, and D. Forero for assistance in gathering preliminary data for the project. M. NuÃ±ez, A. S. Mason, three anonymous reviewers, and Ludo Waltman provided feedback on the manuscript.

# Competing Interests

The authors declare that there are no competing interests.

# Funding Information 

This research was not funded.  

# Data Availability

The complete citation records were downloaded from the Web of Science Core Collection and SCOPUS; while the complete original records cannot be made available due to copyright restrictions, a processed version of these records with the additional data needed to reproduce the analyses presented here has been archived at Zenodo (https://doi.org/10.5281/zenodo.5500293). This archive also includes the version of the R code used to process the raw data, carry out the analyses on the processed data, and create the figures, tables, and manuscript. Updates to the code will are available on Github (https://github.com/BrunaLab/APCdiversity), where users can also make suggestions for improvement.

\newpage

# References

```{=tex}
\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
```
::: {#refs custom-style="Bibliography"}


\endgroup

```{r richdivfigs1, echo=FALSE,message = FALSE,cached=TRUE,warning=FALSE}
insert_custom1 <- n_OA
insert_custom2 <- n_PW
insert_custom3 <- n_OAinPW
# Figure - Diversity
source("./Rscript/functions_ms/fig_div_boot.R")
DivBootFig <- fig_div_boot(BootMirror_RichDiv, single_ALL, single_NOCHNUSA, first_ALL, first_NOCHNUSA)

# Figure - Richness
source("./Rscript/functions_ms/fig_rich_boot.R")
RichBootFig <- fig_rich_boot(BootMirror_RichDiv, single_ALL, first_ALL, single_NOCHNUSA, first_NOCHNUSA)

```

```{r richdivfigs2, echo=FALSE, message = FALSE, warning=FALSE}
source("./Rscript/functions_ms/fig_countries.R")
p1 <- fig_countries(single_ALL, "author_first", "OA", "OA", 15)
p2 <- fig_countries(single_ALL, "author_first", "PW", "OA", 15)
p3 <- fig_countries(single_ALL, "author_first", "PW", "PW", 15)
p4 <- fig_countries(first_ALL, "author_first", "OA", "OA", 15)
p5 <- fig_countries(first_ALL, "author_first", "PW", "OA", 15)
p6 <- fig_countries(first_ALL, "author_first", "PW", "PW", 15)
```

```{r Fig1, fig.align='center',fig.cap="For single-author papers: (A) the percentage of authors of articles in open access (OA) Mirror journals that are based in different countries, (B) the percentage of authors of OA articles in Parent journals that are based in different countries, and (C) the percentage of authors of non-OA articles in Parent journals that are based in different countries. Numbers adjacent to bars are the number of articles with lead authors based in that country.",fig.height = 9,fig.width=6}
# tiff("./manuscript/figs_final/fig_01", units="in", width=6, height=8, res=700)
fig01<-grid.arrange(p1, p2, p3, ncol = 1)
fig01
# insert ggplot code
# dev.off()
# ggsave(fig01, path = "./Rscript/manuscript/figs_final", width = 5, height = 8, device='tiff', dpi=700)
```

```{r Fig2, fig.align='center',fig.cap="For coauthored papers: (A) the percentage of authors of articles in open access (OA) Mirror journals that are based in different countries, (B) the percentage of authors of OA articles in Parent journals that are based in different countries, and (C) the percentage of authors of non-OA articles in Parent journals that are based in different countries. Numbers adjacent to bars are the number of articles with lead authors based in that country.",fig.height = 9,fig.width=6}
# coauthored, first author, OA

# 
# tiff("./manuscript/figs_final/fig_02", units="in", width=6, height=8, res=700)
fig02<-grid.arrange(p4, p5, p6, ncol = 1)
fig02
# insert ggplot code
# dev.off()
```

<!-- # ```{r Fig3, fig.align='center', fig.cap=paste("Author Geographic Richness for N = ", insert_custom1," Open Access articles (red bar) and 1000 identically sized collections of non-OA articles selected by bootstrapping from a pool of ",insert_custom2, " articles."), fig.fullwidth=TRUE} -->

<!-- RichBootFig[[1]] -->

<!-- ``` -->

<!-- fig.cap=paste("Author Geographic Diversity ($D_2$) for the N = ", insert_custom3, " open access articles in Parent jorunals (dashed line), the N = ", insert_custom1, " articles in Mirror journals (solid line), and 1000 bootstrap-selected samples from the N = ",insert_custom2, " subscription-only articles in Parent journals. The bootstrap samples were identical in size and structure to the collection of articles published in Mirror journals.") -->

```{r Fig3, fig.align='center', fig.cap=paste("Geographic Diversity ($D_2$) of authors publishing N = ", insert_custom1, " articles in Mirror journals (dashed line) and 1000 collections of N = ", insert_custom1, " non-OA articles in Parent journals (sampled from N = ",insert_custom2, " articles by bootstrapping)."),fig.fullwidth=TRUE}
# DivBootFig[[1]]
# tiff("./manuscript/figs_final/fig_03", units="in", width=6, height=6, res=700)
DivBootFig
# dev.off()
```

```{r IncomeRegionFIgs, cached=TRUE,echo=FALSE, message = FALSE, warning=FALSE}
source("./Rscript/functions_ms/fig_income.R")
IncomePlot <- fig_income(BootMirror_RichDiv, BootMirror_Countries, "All", single_ALL, single_NOCHNUSA, first_ALL, first_NOCHNUSA)
source("./Rscript/functions_ms/fig_region.R")
RegionPlot <- fig_region(BootMirror_RichDiv, BootMirror_Countries, "All", single_ALL, single_NOCHNUSA, first_ALL, first_NOCHNUSA)
source("./Rscript/functions_ms/fig_waiver_grp.R")
WaiverPlot <- fig_waiver_grp(BootMirror_RichDiv, BootMirror_Countries, "All", single_ALL, single_NOCHNUSA, first_ALL, first_NOCHNUSA, WaiverCountries)

Fig_Income <- IncomePlot[[1]]
Fig_Region <- RegionPlot[[1]]
Fig_Waiver <- WaiverPlot[[1]]
```

```{r Fig4, echo=FALSE,message = FALSE, warning=FALSE, fig.align='center', fig.cap=paste("Percentage of first authors that are based in different global regions. The dashed line is the value for N = ",insert_custom1," articles in open access (OA) Mirror journals; histograms are values for 1000 identically sized collections of non-OA articles from Parent journals (sampled by bootstrapping from N = ",insert_custom2," articles). All countries, including the USA and China, are included."),fig.fullwidth=TRUE,fig.height = 24,fig.width=20}
# 
# tiff("./manuscript/figs_final/fig_04", units="cm", width=35, height=45, res=700)

Fig_Region

# dev.off()
```

```{r Fig5, echo=FALSE, message = FALSE, warning=FALSE, fig.align='center', fig.cap=paste("Percentage of first authors that are based in different World Bank Lending Groups. The dashed line is the value for N = ",insert_custom1," articles in open access (OA) Mirror journals; histograms are values for 1000 identically sized collections of non-OA articles from Parent journals (sampled by bootstrapping from N = ",insert_custom2," articles). All countries, including the USA and China, are included."), fig.fullwidth=TRUE,fig.height = 24,fig.width=20}

# tiff("./manuscript/figs_final/fig_05", units="cm", width=35, height=45, res=700)
Fig_Income
# dev.off()
```

```{r Fig6, echo=FALSE, message = FALSE, warning=FALSE, fig.align='center', fig.cap=paste("Percentage of first authors that are based in different Elsevier Waiver Groups. The solid line is the value for N = ",insert_custom1," articles in Mirror journals; histograms are values for 1000 identically sized collections of subscription articles from Parent journals (sampled by bootstrapping from N = ",insert_custom2," articles)."), fig.fullwidth=TRUE,fig.height = 24,fig.width=20}
# tiff("./manuscript/figs_final/fig_06", units="cm", width=35, height=45, res=700)
Fig_Waiver
# dev.off()
```

```{r mirrorVpw_OA, echo=FALSE, message = FALSE, warning=FALSE}


source("./Rscript/functions_ms/fig_oa_v_oa.R")
fig_NbyN <- fig_oa_v_oa(AllData, 20)

```

```{r Fig7, echo=FALSE, message = FALSE, warning=FALSE, fig.align='center', fig.cap="For the 20 countries publishing the most open access (OA) articles, the number of OA articles published in Mirror Journals vs. OA articles published in Parent journals. Abbreviations: DNK=Denmark, AUT=Austria, NOR=Norway, KOR=South Korea, SWE=Sweden, BEL=Belgium, CHE=Switzerland, ESP=Spain, CAN=Canada, ITA=Italy, DEU=Germany, IND=India, JPN=Japan, BRA=Brazil, AUS=Australia, FRA=France, NLD=Netherlands, GBR=Great Britain, CHN=China, USA=United States of America.)", fig.fullwidth=TRUE,fig.height = 18,fig.width=18}

# tiff("./manuscript/figs_final/fig_07", units="cm", width=35, height=35, res=700)

fig_NbyN

# dev.off()
```

```{r Table1, echo=FALSE,message = FALSE,warning=FALSE}
source("./Rscript/functions_ms/table_journals.R")
Tables <- table_journals(AllData, MirrorPairs)
Table1 <- Tables[2]
Table1 <- as.data.frame(Table1)
Table1$Journal <- gsub("Gynecology", "Gyn", Table1$Journal)
Table1$Journal <- gsub(" and ", " & ", Table1$Journal)
Table1$Journal <- gsub("Journal", "J", Table1$Journal)
Table1$Journal <- gsub("Reproductive Biology", "Repro Bio", Table1$Journal)
names(Table1) <- c("Title", "Subscription", "Open Access", "Open Access", "Mirror", "Parent")
Table1[4, 1] <- "BiochimieSuper1"
Table1[27, 1] <- "Microelectronic EngineeringSuper2"
# Table1[39,4]<-""
Table1[39, 1] <- "Total No. of Articles"
Table1[39, 5] <- ""
Table1[39, 6] <- ""
# Table1[39,4]<-sum_mirror
# Table1<-arrange(Table1,desc(Table1[4]))

tmp <- knitr::kable(Table1,
  digits = 2,
  align = "lccccc",
  format = "latex",
  row.names = FALSE,
  booktabs = T,
  linesep = "", # removes the blank line after every 5 lines
  caption = "Parent journals published by Elsevier included in this study, the number of open access (OA) and non-OA articles they published during our focal time-frame, the number of articles published in each Mirror journal during the same time period, and the article processing charge (APC) charged by each journal for OA publication. With two exceptions the titles of Parent and Mirror journals are identical except for the 'X' at the end of Mirror versions (e.g., Research Policy X, Optical Materials X)."
) %>%
  # column_spec (1, width="8cm") %>%
  row_spec(38, hline_after = TRUE) %>%
  kable_styling(
    bootstrap_options = c("hover"),
    # full_width = F,
    latex_options = "scale_down",
    font_size = 12,
    position = "left"
  ) %>%
  footnote(number = c("OA Mirror title: Biochimie Open", "OA Mirror title: Micro and Nano Engineering")) %>%
  add_header_above(c(" " = 1, "Parent Journal" = 2, "Mirror Journal" = 1, "APC (US$)" = 2))
tmp <- str_replace(tmp, "Super1", "$^{1}$")
tmp <- str_replace(tmp, "Super2", "$^{2}$")
knitr::asis_output(tmp)

```

```{r Table2, echo=FALSE,message = FALSE,warning=FALSE}
source("./Rscript/functions_ms/table_div_results.R")
Table2 <- table_div_results(
  single_ALL,
  single_NOCHNUSA,
  first_ALL,
  first_NOCHNUSA
)

Table2 <- Table2 %>%
  mutate(`OA Source` = ifelse(`OA Source` == "parent", "Parent", `OA Source`)) %>%
  mutate(`OA Source` = ifelse(`OA Source` == "mirror", "Mirror", `OA Source`))


Table2 <- Table2 %>%
  filter(Metric == "Diversity") %>%
  select(-Metric) %>%
  arrange(desc(Author))

blank_row <- rep(NA, 8)
names(blank_row) <- names(Table2)
single <- Table2 %>% filter(Author == "Single")
first <- Table2 %>% filter(Author == "First")
Table2 <- bind_rows(single, blank_row, first)


Table2$Author <- c("Single", "", "", "First", "")

colnames(Table2) <- c(
  "Author",
  "OA",
  paste("Parent PW", "(mean \u00B1 SD)", sep = " "),
  "$\\hat{P}$",
  "Mirror",
  paste("Parent PW2", "(mean \u00B1 SD)", sep = " "),
  "$\\hat{P2}$",
  "OA Source"
)

Table2 <- Table2 %>% select(
  "Author",
  "OA Source",
  "OA",
  "Parent PW (mean Â± SD)",
  "$\\hat{P}$",
  "Mirror",
  "Parent PW2 (mean Â± SD)",
  "$\\hat{P2}$"
)


colnames(Table2) <- c(
  "Author",
  "OA Source",
  "OA",
  "Psub (mean Â± SD)",
  "$\\hat{P}$",
  "OA",
  "Psub (mean Â± SD)",
  "$\\hat{P}$"
)


# # #
kable(Table2,
  digits = 2,
  format = "latex",
  align = "llrccrcc",
  escape = FALSE,
  row.names = FALSE,
  booktabs = T,
  linesep = "",
  caption = "Geographic Diversity of lead authors publishing Open Access (i.e., OA) articles in Mirror and Parent journals vs. subscription-only, non-OA, articles in Parent journals (Psub). The value for Psub is the mean of 1000 bootstrap-generated article collections identical in size and structure to each OA group with which they are being compared (i.e., OA in Mirror, OA in Parent). Single: authors of single-authored articles; First: first authors of co-authored articles. Note that because  Diversity values are sample-size dependent, it is not appropriate to compare values generated for one comparison with those generated for another (e.g., Single author OA articles in Parent Journals with First author OA articles in Mirror journals)."
) %>%
  kable_styling(
    bootstrap_options = c("hover"),
    # full_width = F,
    latex_options = c("scale_down"),
    # latex_options = c("hold_position"),
    font_size = 12,
    position = "center"
  ) %>%
  add_header_above(c(" " = 2, "All Countries" = 3, "China & USA Excluded" = 3))
```

```{r Table3, echo=FALSE,message = FALSE,warning=FALSE}
stipends <- read_csv(file = "./data_clean/stipends.csv")
stipends <- as.data.frame(stipends)
stipends$agency <- c("CNPq", "", "CONACYT", "", "SERB", "", "RISTEKDIKTI", "NRF", "")
source <- stipends$source
stipends <- stipends %>% select(country, agency, degree, stipend_USD)
names(stipends) <- c("Country", "Agency", "Degree", "Stipend (US$)")
stipends[5, 3] <- "PhDSuper6"
stipends[6, 3] <- "PhDSuper7"
stipends[6, 1] <- ""
stipends[1, 2] <- "CNPqSuper1"
stipends[2, 1] <- ""
stipends[3, 2] <- "CONACYTSuper2"
stipends[4, 1] <- ""
stipends[5, 2] <- "SERBSuper3"
stipends[7, 2] <- "RISTEKDIKTISuper4"
stipends[8, 2] <- "NRFSuper5"
stipends[9, 1] <- ""

foot6 <- "Min. value, Prime Ministerâs Doctoral Fellowship"
foot7 <- "Max. value, Prime Ministerâs Doctoral Fellowship"
foot1 <- source[1]
foot2 <- source[3]
foot3 <- source[5]
foot4 <- source[7]
foot5 <- source[8]
foot5 <- "https://www.nrf.ac.za"
# foot4<-gsub("%20Scholarships%","%20Scholarships\n%",foot4)
# stipends[4]<-NULL
tmp <- knitr::kable(stipends,
  digits = 1,
  format = "latex",
  align = "lllc",
  row.names = FALSE,
  booktabs = T,
  linesep = "",
  caption = "Monthly stipends for graduate students in select countries. The value of the stipend in US currency is based on the exchange rate in December 2020."
) %>%
  kable_styling(
    bootstrap_options = c("hover"),
    # latex_options = c("scale_down","hold_position"),
    # full_width = F,
    font_size = 12,
    position = "center"
  ) %>%
  footnote(number = c(foot1, foot2, foot3, foot4, foot5, foot6, foot7))
tmp <- str_replace(tmp, "Super1", "$^{1}$")
tmp <- str_replace(tmp, "Super2", "$^{2}$")
tmp <- str_replace(tmp, "Super3", "$^{3}$")
tmp <- str_replace(tmp, "Super4", "$^{4}$")
tmp <- str_replace(tmp, "Super5", "$^{5}$")
tmp <- str_replace(tmp, "Super6", "$^{6}$")
tmp <- str_replace(tmp, "Super7", "$^{7}$")

knitr::asis_output(tmp)
```

```{r Table4, echo=FALSE,message = FALSE,warning=FALSE}
RegionTable <- RegionPlot[2]
RegionTable <- as.data.frame(RegionTable)

Subsampled_Region_summary <- BootMirror_Countries %>%
  filter(BootType == "MirrorvPW") %>%
  group_by(author, Dataset, replicate, Region) %>%
  filter(Dataset == "All Countries") %>%
  drop_na() %>%
  summarize(n = n()) %>%
  mutate(perc = n / sum(n) * 100)
# str(Subsampled_Region_summary)
# levels(as.factor(Subsampled_Region_summary$replicate))
PW_means <- Subsampled_Region_summary %>%
  group_by(author, Dataset, Region) %>%
  summarise(mean = mean(perc)) %>%
  dplyr::rename(
    "Countries" = "Dataset",
    "Author" = "author",
    "mean PW percentage" = "mean"
  ) %>%
  mutate(Countries = ifelse(Countries == "all", "All Countries", Countries))


PW_means$Author <- gsub("solo", "Single", PW_means$Author)
PW_means$Author <- gsub("author_first", "First", PW_means$Author)

# RegionTable<-RegionTable %>% filter(ArticleCat=="OA")

RegionTable <- left_join(RegionTable, PW_means) %>%
  select(Author, Countries, Region, `mean PW percentage`, OA_perc, P_Hat)
#   %>%
#   mutate(asterisk = ifelse((P_Hat >= 0.975 |P_Hat <= 0.025 ), "*", " "))
# RegionTable$P_Hat<-paste(RegionTable$P_Hat,RegionTable$asterisk,sep="")
# RegionTable$asterisk<-NULL

RegionTable_single <- RegionTable %>%
  select(Author, Countries, Region, "mean PW percentage", OA_perc, P_Hat) %>%
  filter(Author == "Single")

RegionTable_first <- RegionTable %>%
  select(Author, Countries, Region, "mean PW percentage", OA_perc, P_Hat) %>%
  filter(Author == "First")


RegionTable_single$Region <- factor(RegionTable_single$Region, levels = c(
  "South Asia",
  "North America",
  "Sub-Saharan Africa",
  "Latin America & Caribbean",
  "Middle East & North Africa",
  "East Asia & Pacific",
  "Europe & Central Asia"
))


RegionTable_first$Region <- factor(RegionTable_first$Region, levels = c(
  "South Asia",
  "North America",
  "Sub-Saharan Africa",
  "Latin America & Caribbean",
  "Middle East & North Africa",
  "East Asia & Pacific",
  "Europe & Central Asia"
))

RegionTable <- bind_rows(RegionTable_single, RegionTable_first)
RegionTable <- RegionTable %>% arrange(desc(Author), Region)



blank_row <- rep(NA, 6)
names(blank_row) <- names(RegionTable)
single <- RegionTable %>% filter(Author == "Single")
first <- RegionTable %>% filter(Author == "First")
RegionTable <- bind_rows(single, blank_row, first)





RegionTable <- RegionTable %>%
  mutate(Author = replace(Author, Region != "South Asia", ""))


RegionTable$Countries <- ""


RegionTable <- RegionTable %>%
  mutate(Countries = replace(
    Countries,
    ((Region == "South Asia" & Author == "Single")), "All Countries"
  ))




colnames(RegionTable) <- c(
  "Author",
  "Countries",
  "Region",
  "non-OA Parent",
  "Mirror",
  "$\\widehat{P}$"
)



RegionTable <- RegionTable %>% select(
  "Countries",
  "Author",
  "Region",
  "non-OA Parent",
  "Mirror",
  "$\\widehat{P}$"
)




kable(RegionTable,
  digits = 2,
  align = "lllccc",
  format = "latex",
  row.names = FALSE,
  escape = TRUE,
  booktabs = T,
  linesep = "", # removes the blank line after every 5 lines
  caption = "Percentage of articles in open access (OA) Mirror journals whose authors are based in different World Bank Regions. The value for non-OA articles in Parent journals is the mean percentage of 1000 bootstrap-generated samples identical in size and structure to the articles published in Mirror journals. Single: authors of single-authored papers; First: first authors of co-authored papers."
) %>%
  kable_styling(
    bootstrap_options = c("hover"),
    # full_width = F,
    # latex_options="scale_down",
    font_size = 12,
    position = "center"
  )

```

```{r Table5, echo=FALSE,message = FALSE,warning=FALSE}
IncomeTable <- IncomePlot[2]
IncomeTable <- as.data.frame(IncomeTable)


Subsampled_Income_summary <- BootMirror_Countries %>%
  group_by(author, Dataset, replicate, IncomeGroup) %>%
  filter(Dataset == "All Countries") %>%
  drop_na() %>%
  summarize(n = n()) %>%
  mutate(perc = n / sum(n) * 100)
# str(Subsampled_Region_summary)
# levels(as.factor(Subsampled_Region_summary$replicate))


PW_means <- Subsampled_Income_summary %>%
  group_by(author, Dataset, IncomeGroup) %>%
  summarise(mean = mean(perc)) %>%
  dplyr::rename(
    "Author" = "author",
    "PW (mean %)" = "mean"
  ) %>%
  mutate(Dataset = ifelse(Dataset == "all", "All Countries", Dataset))
PW_means$IncomeGroup <- gsub(" income", "", PW_means$IncomeGroup)

PW_means$Author <- gsub("solo", "Single", PW_means$Author)
PW_means$Author <- gsub("author_first", "First", PW_means$Author)

# IncomeTable<-IncomeTable %>% filter(ArticleCat=="OA")

IncomeTable <- left_join(IncomeTable, PW_means) %>%
  select(Author, Countries, IncomeGroup, `PW (mean %)`, OA_perc, P_Hat)

#   %>%
#     mutate(asterisk = ifelse((P_Hat >= 0.975 |P_Hat <= 0.025 ), "*", " "))
#
# IncomeTable$P_Hat<-paste(IncomeTable$P_Hat,IncomeTable$asterisk,sep="")
# IncomeTable$asterisk<-NULL

IncomeTable_single <- IncomeTable %>%
  select(Author, Countries, IncomeGroup, "PW (mean %)", OA_perc, P_Hat) %>%
  filter(Author == "Single")

# Author<-("")
# Countries<-("")
# IncomeGroup<-("Low")
# OA_perc<-("-")
# P_Hat<-("-")
# foo <- data.frame(Author,Countries,IncomeGroup,OA_perc,P_Hat)
# foo[] <- lapply(foo, as.character)
# IncomeTable_single[]<-lapply(IncomeTable_single, as.character)
# IncomeTable_single<-bind_rows(IncomeTable_single,foo)


IncomeTable_first <- IncomeTable %>%
  select(Author, Countries, IncomeGroup, "PW (mean %)", OA_perc, P_Hat) %>%
  filter(Author == "First")
# IncomeTable_first[]<-lapply(IncomeTable_first, as.character)
# IncomeTable_first<-bind_rows(IncomeTable_first,foo)



IncomeTable <- bind_rows(IncomeTable_single, IncomeTable_first)

IncomeTable$IncomeGroup <- as.character(IncomeTable$IncomeGroup)
IncomeTable$IncomeGroup <- gsub("Upper middle", "Upper-middle", IncomeTable$IncomeGroup)
IncomeTable$IncomeGroup <- gsub("Lower middle", "Lower-middle", IncomeTable$IncomeGroup)
IncomeTable$IncomeGroup <- as.factor(IncomeTable$IncomeGroup)

blank_row <- rep(NA, 6)
names(blank_row) <- names(IncomeTable)
single <- IncomeTable %>% filter(Author == "Single")
first <- IncomeTable %>% filter(Author == "First")

first$IncomeGroup <-
  ordered(first$IncomeGroup,
    levels = c(
      "High",
      "Upper-middle",
      "Lower-middle",
      "Low"
    )
  )


first <- first %>% arrange(desc(Author), desc(IncomeGroup))

single$IncomeGroup <-
  ordered(single$IncomeGroup,
    levels = c(
      "High",
      "Upper-middle",
      "Lower-middle",
      "Low"
    )
  )


single <- single %>% arrange(desc(Author), desc(IncomeGroup))

IncomeTable <- bind_rows(single, blank_row, first)

IncomeTable$Countries <- gsub("All Countries", "", IncomeTable$Countries)

IncomeTable <- IncomeTable %>%
  mutate(Countries = replace(Countries, ((IncomeGroup == "Lower-middle") & (Author == "Single")), "All Countries"))


IncomeTable <- IncomeTable %>%
  mutate(Author = replace(
    Author,
    ((Author == "Single") &
      (Countries != "All Countries")), ""
  ))


IncomeTable <- IncomeTable %>%
  mutate(Author = replace(
    Author,
    ((Author == "First") &
      (IncomeGroup != "Low")), ""
  ))



# IncomeTable$OA_perc<-as.numeric(IncomeTable$OA_perc)
colnames(IncomeTable) <- c(
  "Author",
  "Countries",
  "Lending Group",
  "non-OA Parent",
  "Mirror",
  "$\\hat{P}$"
)


# IncomeTable$OA_perc<-as.numeric(IncomeTable$OA_perc)
IncomeTable <- IncomeTable %>% select(
  "Countries",
  "Author",
  "Lending Group",
  "non-OA Parent",
  "Mirror",
  "$\\hat{P}$"
)



# IncomeTable$'Open Access (%)'<-round(IncomeTable$'Open Access (%)',2)
# IncomeTable$'Open Access (%)'<-as.character(IncomeTable$'Open Access (%)')
# IncomeTable<-IncomeTable %>% replace_na(list('Open Access (%)'="-"))
kable(IncomeTable,
  digits = 2,
  align = "lllccc",
  format = "latex",
  row.names = FALSE,
  escape = FALSE,
  booktabs = T,
  linesep = "", # removes the blank line after every 5 lines
  caption = "Percentage of articles in open access (OA) mirror journal whose authors are based in countries from different World Bank Lending Groups. The value for non-OA articles in Parent journals is the mean percentage of 1000 bootstrap-generated samples identical in size and structure to the articles published in Mirror journals. Single: authors of single-authored papers; First: first authors of co-authored papers."
) %>%
  kable_styling(
    bootstrap_options = c("hover"),
    # full_width = F,
    # latex_options="scale_down",
    font_size = 12,
    position = "center"
  )
```



<!-- ```{r echo = FALSE, results = 'asis', cache = FALSE} -->
<!-- papaja::render_appendix('Smith_etal_Appendix_QSSv1.Rmd') -->
<!-- ``` -->

